<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>dev@cloudburo | Docker Small Hints #3: SSH into your AWS Elastic Beanstalk Component</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><!--[if lt IE 9]><script src="../../../js/ie8.js" type="text/javascript"></script><![endif]--><link href="../../../css/all.css" media="screen" rel="stylesheet" type="text/css" /><script type="text/javascript">
      (function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-35696879-1", location.hostname);ga("send","pageview");
    </script>
    <link href="/favicon.png" rel="icon" type="image/png" />
    <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet" />
    <link href="http://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
    <!--HTML5 shiv for IE8 support--><!--[if lt IE 9]
    | <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script-->
  </head>
  <body>
    <div class="col-sm-3 sidebar" id="secondary" style="display: none;">
      <aside>
        <div class="about">
          <h4>
            <a class="sidebarlink" href="/"><i class="fa fa-chevron-right"></i>    Home     <i class="fa fa-home"></i></a>
          </h4>
          <h4>
            <a class="sidebarlink" href="/menu1.html"><i class="fa fa-chevron-right"></i>    About   </a>
          </h4>
          <h4>
            <a class="sidebarlink" href="/menu2.html"><i class="fa fa-chevron-right"></i>    Contact   </a>
          </h4>
        </div>
        <div class="tags">
          <h4>
            Categories
          </h4>
          <ul class="list-unstyled">
            <a class="label label-default" href="/tags/api.html">api (2)</a>
            <a class="label label-default" href="/tags/architecture.html">architecture (10)</a>
            <a class="label label-default" href="/tags/aws.html">aws (10)</a>
            <a class="label label-default" href="/tags/banking.html">banking (1)</a>
            <a class="label label-default" href="/tags/blockchain.html">blockchain (1)</a>
            <a class="label label-default" href="/tags/bots.html">bots (1)</a>
            <a class="label label-default" href="/tags/deutsch.html">deutsch (1)</a>
            <a class="label label-default" href="/tags/docker.html">docker (9)</a>
            <a class="label label-default" href="/tags/futurework.html">futureWork (5)</a>
            <a class="label label-default" href="/tags/googleapps.html">googleapps (1)</a>
            <a class="label label-default" href="/tags/gradle.html">gradle (2)</a>
            <a class="label label-default" href="/tags/inspiration.html">inspiration (2)</a>
            <a class="label label-default" href="/tags/legal.html">legal (1)</a>
            <a class="label label-default" href="/tags/meteor.html">meteor (5)</a>
            <a class="label label-default" href="/tags/microservice.html">microservice (12)</a>
            <a class="label label-default" href="/tags/modeling.html">modeling (1)</a>
            <a class="label label-default" href="/tags/personaldata.html">personalData (2)</a>
            <a class="label label-default" href="/tags/quicktips.html">quicktips (12)</a>
            <a class="label label-default" href="/tags/shift.html">shift (4)</a>
            <a class="label label-default" href="/tags/smallhints.html">smallhints (13)</a>
            <a class="label label-default" href="/tags/startup.html">startup (10)</a>
          </ul>
        </div>
        <div class="timeline">
        </div>
      </aside>
    </div>
    <!--/#secondary-->
    <div class="col-sm-12" id="primary">
      <div class="content">
        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              <a href="/">dev@cloudburo</a>
            </h1>
          </hgroup>
          <div class="btn btn-primary pull-right" id="togglesidebar">
            <i class="fa fa-bars"></i>
          </div>
        </header>
        <section class="post">
          <header class="entry-header">
            <h2 class="entry-title">
              <a href="/2015/04/25/docker-small-hints-3-ssh-into-your-aws-elastic-beanstalk-component.html">Docker Small Hints #3: SSH into your AWS Elastic Beanstalk Component</a>
            </h2>
            <p class="entry-meta">
              Posted on  25. Apr 2015 | Tags <a class="label label-primary" href="/tags/docker.html">docker</a> <a class="label label-primary" href="/tags/aws.html">aws</a> <a class="label label-primary" href="/tags/smallhints.html">smallhints</a> 
            </p>
          </header>
          <div class="entry-description"><div class="row">
  <div class="article"><p><span/>      <div>
    Was quite a hassle in the past to setup SSH connectivity into your Elastic Beanstalk instance, luckly this got simplified. With the 
   <i>eb</i> Version 3 command tool you get all the necessary support.<br>
  </div> 
  <div> 
   <br> 
  </div> 
  <div>
    First install the<br>
   <i>eb cli</i> interface, as described here 
  </div> 
  <div> 
   <br> 
  </div> 
  <div> 
   <a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-getting-set-up.html"><a href="http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-getting-set-up.html">http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/eb-cli3-getting-set-up.html</a></a> 
  </div> 
  <div> 
   <br> 
  </div> 
  <div>
    Run 
   <i> eb init</i>, which will configure the eb command line to one of your running 
   <i>eb</i> instances. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight plaintext"><code>
iMac:~ Felix$ eb init 
  Select a default region
 1) us-east-1 : US East (N. Virginia) 
  2) us-west-1 : US West (N. California) 
  ... 
  (default is 3): 
  Select an application to use 
  1) curationApp
 2) [ Create new Application ] 
  (default is 2): 1 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    Now configure your EB Environment to allow ssh inbound traffic, via<br>
   <i>eb ssh â€”setup</i> command. Be aware that will result in a re-creation of your EB environment. 
  </div> 
  <div>
    Amongst others the command will create the public/private keypair as well which is put under the default name 
   <i>aws-eb</i> into your local<br>
   <i>.ssh</i> directory 
  </div> 
  <div> 
   <div> 
    <br> 
   </div> 
   <div></p>
<pre class="highlight plaintext"><code>
iMac:~ Felix$ eb ssh --setup
 WARNING: You are about to setup SSH for environment "curationApp-prod". If you continue, your existing instances will have to be **terminated** and new instances will be created. The environment will be temporarily unavailable. 
  To confirm, type the environment name: curationApp-prod 
  Type a keypair name.
 (Default is aws-eb):
 Generating public/private rsa key pair. 
   ... 

  Your identification has been saved in /Users/Felix/.ssh/aws-eb. 
   ... 
  WARNING: Uploaded SSH public key for "aws-eb" into EC2 for region us-west-2. 
  INFO: Environment update is starting.                              
 INFO: Updating environment curationApp-prod's configuration settings.
 INFO: Created Auto Scaling launch configuration named: awseb-e-...-stack-AWSEBAutoScalingLaunchConfiguration-1D8ET9F9BZ592
 INFO: Deleted Auto Scaling launch configuration named: awseb-e-...-stack-AWSEBAutoScalingLaunchConfiguration-8JDT6IAKL1QQ 
  INFO: Successfully deployed new configuration to environment.  

</code></pre>

<div> 
    <br> 
   </div> 

<p></div> 
  <div>
    You are now ready to connect with the<br>
   <i>eb ssh</i> command. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight plaintext"><code>
iMac: ~ Felix$ eb ssh 
  INFO: Attempting to open port 22. 
  INFO: SSH port 22 open. 
         __|  __|_  )
        _|  (     /   Amazon Linux AMI 
        ___|\___|___| 
  [ec2-user ~]$  

</code></pre>

<div> 
   <span style="font-size: 18px;"><br></span> 
  </div> 

<p><div>
    Log files of your instances can be found in the 
   <span style="">/var/log</span> directory.  The log file of your en-docker instance you will find in the following subdirectory. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight plaintext"><code>
[ec2-user ~]$ cd  /var/log/eb-docker/containers/eb-current-app 
  [ec2-user eb-current-app]$ ls -l  
  insgesamt 136
 -rw-r--r-- 1 root root 67113425 14. Mai 06:34 894d84f26a6a-stdouterr.log 
  drwxr-xr-x 2 root root     4096 14. Mai 06:01 rotated 

</code></pre>

<p></div> 
  <div></p>

<p></div> 
  <div> 
   <br> 
  </div> 
  <div> 
   <span style="font-size: 18px;"><b>Looking at the details of the configuration triangle</b></span> 
  </div> 
  <div> 
   <br> 
  </div> 
  <div>
    Memorize the following picture, which shows you the major concepts of a EC2 setup.  AWS EC2 is the underlying Linux Container Infrastructure on top of which your EB managed Docker Applications will run. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div>
    You Docker Container will run within one EC2 instance, represented by the orange Instance box. For each EB Docker Instance there will be one EC2 Instance instantiated. 
  </div> 
  <div> 
   <div> 
    <br> 
   </div> 
  </div> 
  <div></p>

  </div>
  <img class="img-responsive img-thumbnail article" src="/images/820746984edb2ecb86de31973a2d854e.png" />
  <div class="article">
    <p><span/> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div>
        The EC2 instance will have Security Groups to control the access. There is a Security Group for each  EB-Instance you are running, which by default allows inbound access from the http port. This security group is now extended to allow SSH inbound traffic. 
      </div> 
      <div>
        In the dashboard you will see a  Security Group Name which contains the substring 
       <i>AWSEBSecurityGroup (</i>this value is also a tag value of the group for tag name<br>
       <i>aws:cloudformation:logical-id</i> (Tab Tags)) 
      </div> 
      <div> 
       <br> 
      </div> 
      <div></p>
    
  </div>
  <img class="img-responsive img-thumbnail article" src="/images/74509d1957c1fcb41391de8fb8add8f9.png" />
  <div class="article">
    <p><span/> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div>
        This Security Group 
       <i><em>ASWEBSecurityGroup</em></i> is the configured Security Group of your EC2 docker instance running the EB environment. You would find the link in the column security group when click on Instances (left hand menu) in the Dashboard 
      </div> 
      <div> 
       <br> 
      </div> 
      <div></p>
    
  </div>
  <img class="img-responsive img-thumbnail article" src="/images/0e16630c0c6e65305ffbd4d961df9e45.png" />
  <div class="article">
    <p><span/> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div>
        As mentioned above a Key Pair was created with the default name 
       <i>aws_eb</i> (left hand menu Key Pairs). The eb setup command made sure that this key pair was downloaded to your local .ssh directory. 
      </div> 
      <div> 
       <br> 
      </div> 
      <div></p>
    
  </div>
  <img class="img-responsive img-thumbnail article" src="/images/a84b6851d2333a7ea9ff8cdd848ac43e.png" />
  <div class="article">
    <p><span/> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div>
        So now we have (1) a EC2 Instance configured with (2) a  Security Group for SSH inbound traffic and we have (3) a Public/Private key pair  which allows us to authenticate ourselves.<br>
      </div> 
      <div> 
       <br> 
      </div> 
      <div>
        The missing combination of (2) Security Group with (3) Key Pair can be found in the Elastic Beanstalk Dashboard via the Server Configuration tab. You can see here the Security Group as well as the drop box EC2 key pair, which ties the relevant Key Pair to the configuration. Thatâ€™s it. 
      </div> 
      <div></p>
    
  </div>
  <img class="img-responsive img-thumbnail article" src="/images/58931d9f39e7ac379c3d099e40f2e74b.png" />
  <div class="article">
    <p><span/> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div> 
       <br> 
      </div> 
      <div> 
       <br> 
      </div></p>
    
  </div>
</div>
            <div class="comments">
              <div id="disqus_thread">
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                //<![CDATA[
                                  var disqus_shortname = 'dev1cloudburo';
                          
                    (function() {
                        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                //]]>
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                <script type="text/javascript">
                //<![CDATA[
                    var disqus_shortname = 'dev1cloudburo';
                    (function () {
                        var s = document.createElement('script'); s.async = true;
                        s.type = 'text/javascript';
                        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                    }());
                //]]>
                </script>
                
              </div>
            </div>
          </div>
        </section><footer class="footer">
          <p>
          </p>
          <div class="socials-footer"><a class="btn btn-twitter" href="https://twitter.com/talfco">
                <i class="fa fa-twitter"></i></a><a class="btn btn-facebook" href="https://www.facebook.com/Cloudburonet-897759390318816/">
                <i class="fa fa-facebook"></i></a><a class="btn btn-google-plus" href="https://plus.google.com/u/1/b/102868953630532463137/+CloudburoCh/posts">
                <i class="fa fa-google-plus"></i></a><a class="btn btn-linkedin" href="https://www.linkedin.com/in/felixk">
                <i class="fa fa-linkedin"></i></a><a class="btn btn-github" href="https://github.com/talfco">
                <i class="fa fa-github"></i></a>
          </div>
          <p>
            Â© 2016 All rights reserved 
          </p>
        </footer>
      </div>
    </div>
    <script src="../../../js/all.js" type="text/javascript"></script>
  </body>
</html>