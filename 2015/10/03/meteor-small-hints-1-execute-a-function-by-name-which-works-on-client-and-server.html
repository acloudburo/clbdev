<!doctype html> 
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>dev@cloudburo | Meteor Small Hints #1: Execute a function by name which works on client and server</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><!--[if lt IE 9]><script src="../../../js/ie8.js" type="text/javascript"></script><![endif]--><link href="../../../css/all.css" media="screen" rel="stylesheet" type="text/css" /><script type="text/javascript">
      (function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-35696879-1", location.hostname);ga("send","pageview");
    </script>
    <link href="/favicon.png" rel="icon" type="image/png" />
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" data-target=".navbar-ex1-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">dev@cloudburo</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="/menu1.html"> About  </a>
            </li>
            <li>
              <a href="/menu2.html"> Contact  </a>
            </li>
            <li class="dropdown">
              <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">Categories <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li>
                  <a href="/tags/api.html">api (2)</a>
                </li>
                <li>
                  <a href="/tags/architecture.html">architecture (9)</a>
                </li>
                <li>
                  <a href="/tags/aws.html">aws (9)</a>
                </li>
                <li>
                  <a href="/tags/banking.html">banking (1)</a>
                </li>
                <li>
                  <a href="/tags/bootstrap.html">bootstrap (1)</a>
                </li>
                <li>
                  <a href="/tags/deutsch.html">deutsch (1)</a>
                </li>
                <li>
                  <a href="/tags/docker.html">docker (8)</a>
                </li>
                <li>
                  <a href="/tags/futurework.html">futureWork (5)</a>
                </li>
                <li>
                  <a href="/tags/googleapps.html">googleapps (1)</a>
                </li>
                <li>
                  <a href="/tags/gradle.html">gradle (2)</a>
                </li>
                <li>
                  <a href="/tags/grails.html">grails (2)</a>
                </li>
                <li>
                  <a href="/tags/inspiration.html">inspiration (2)</a>
                </li>
                <li>
                  <a href="/tags/legal.html">legal (1)</a>
                </li>
                <li>
                  <a href="/tags/meteor.html">meteor (3)</a>
                </li>
                <li>
                  <a href="/tags/microservice.html">microservice (12)</a>
                </li>
                <li>
                  <a href="/tags/modeling.html">modeling (1)</a>
                </li>
                <li>
                  <a href="/tags/personaldata.html">personalData (2)</a>
                </li>
                <li>
                  <a href="/tags/quicktips.html">quicktips (12)</a>
                </li>
                <li>
                  <a href="/tags/shift.html">shift (4)</a>
                </li>
                <li>
                  <a href="/tags/smallhints.html">smallhints (13)</a>
                </li>
                <li>
                  <a href="/tags/startup.html">startup (8)</a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
              <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">By Year <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li>
                  <a href="/2016.html">2016 (3)</a>
                </li>
                <li>
                  <a href="/2015.html">2015 (37)</a>
                </li>
                <li>
                  <a href="/2014.html">2014 (10)</a>
                </li>
              </ul>
            </li>
            <ul class="list-unstyled list-inline nav navbar-nav navbar-right"></ul>
            <li><a href="https://twitter.com/talfco">
                        <i class="fa fa-lg fa-inverse fa-twitter-square"></i></a>
            </li>
            <li><a href="https://plus.google.com/u/1/b/102868953630532463137/+CloudburoCh/posts">
                        <i class="fa fa-lg fa-inverse fa-google-plus-square"></i></a>
            </li>
            <li><a href="https://www.linkedin.com/in/felixk">
                        <i class="fa fa-lg fa-inverse fa-linkedin-square"></i></a>
            </li>
            <li><a href="https://github.com/talfco">
                        <i class="fa fa-lg fa-inverse fa-github-square"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row">
        <div class="col-lg-9 col-md-9">
          <h1>
            Meteor Small Hints #1: Execute a function by name which works on client and server
          </h1>
          <small class="label label-default">smallhints</small>
          <small class="label label-default">meteor</small>
          <hr />
          <p>
            <span class="glyphicon glyphicon-time"></span> Posted on Oct  3
          </p>
          <hr /><div class="row">
  <div class="article"><p><span/>      <div>
    Calling a function by name in Meteor gave me at the beginning some headache concerning the passed context. 
   <br> I.e.  the helper function which manages the 
   <i>function by name</i> execution, must work on the client, as well as server side, due to the fact that a Meteor method may be configured for both sides. 
   <br><br>
  </div> 
  <div>
    In my code I have a configuration object which has as an attribute initfunc, which defines a function which should be called in an initalization process. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight json"><code><span class="w">
  </span><span class="p">{</span><span class="w">  
       </span><span class="err">name</span><span class="p">:</span><span class="w"> </span><span class="err">'SiteName'</span><span class="w">  
       </span><span class="err">type:</span><span class="w"> </span><span class="err">'singleton'</span><span class="w"> 
       </span><span class="err">singletonSpace:</span><span class="w"> </span><span class="err">'sitename'</span><span class="w">  
       </span><span class="err">initfunc:</span><span class="w"> </span><span class="err">'Extension.getSiteName'</span><span class="w"> 
   </span><span class="p">}</span><span class="w"> 

</span></code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    The initfunc will be used in the following method call, e.g. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="na">getDefaultFeatureValue</span><span class="o">:</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">-&gt;</span> 
     <span class="nx">configFeature</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">getConfigFeature</span> <span class="nx">name</span> 
     <span class="k">if</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="o">!=</span> <span class="no">undefined</span> 
          <span class="nx">Plattform</span><span class="p">.</span><span class="na">executeFunctionByName</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="nb">window</span> 
     <span class="k">else</span> 
            <span class="nx">configFeature</span><span class="p">.</span><span class="na">init</span> 

</code></pre>

<div> 
   <div> 
    <br> 
   </div> 

<p></div> 
  <div>
    As one can see I pass to the executeFunctionByName the function name, as well as the global window variable as context. The execute function is looking like that. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="na">executeFunctionByName</span> <span class="o">:</span> <span class="p">(</span><span class="nx">functionName</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">-&gt;</span> 
       <span class="nx">args</span> <span class="o">=</span> <span class="na">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="na">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
       <span class="nx">namespaces</span> <span class="o">=</span> <span class="nx">functionName</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> 
       <span class="nx">func</span> <span class="o">=</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">pop</span><span class="p">()</span> 
       <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span> 
       <span class="k">while</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">length</span> 
              <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">namespaces</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> 
               <span class="nx">i</span><span class="o">++</span> 
       <span class="nx">value</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">func</span><span class="p">].</span><span class="na">apply</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">args</span> 
       <span class="k">return</span> <span class="nx">value</span> 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    Now this worked fine to the point where getDefaultFeatureValue was called from a server method as well. 
   <div> 
    <br> 
   </div> The problem was that the global variable window is only defined on the browser. The variable isn’t available in the NodeJS server part and you have to use the global variable. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="nx">Plattform</span><span class="p">.</span><span class="na">executeFunctionByName</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="nx">global</span> 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    I extended the code, so that the caller may not provide the context (in case he wants to call the function in a global context). The function itself will look then for a global context (the typeof code part in the beginning) 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
      <span class="na">executeFunctionByName</span> <span class="o">:</span> <span class="p">(</span><span class="nx">functionName</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">-&gt;</span> 
        <span class="k">if</span> <span class="k">typeof</span> <span class="nx">context</span> <span class="o">==</span> <span class="s">'undefined'</span> 
          <span class="k">if</span>  <span class="k">typeof</span> <span class="nx">global</span> <span class="o">==</span> <span class="s">'undefined'</span> 
            <span class="nx">context</span> <span class="o">=</span> <span class="nb">window</span> 
          <span class="k">else</span> 
            <span class="nx">context</span> <span class="o">=</span> <span class="nx">global</span> 
        <span class="nx">args</span> <span class="o">=</span> <span class="na">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="na">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
        <span class="nx">namespaces</span> <span class="o">=</span> <span class="nx">functionName</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> 
        <span class="nx">func</span> <span class="o">=</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">pop</span><span class="p">()</span> 
        <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="k">while</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">length</span> 
          <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">namespaces</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> 
          <span class="nx">i</span><span class="o">++</span> 
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">func</span><span class="p">].</span><span class="na">apply</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">args</span> 
        <span class="k">return</span> <span class="nx">value</span> 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    The final method was simplified not having to provide the global context. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="na">getDefaultFeatureValue</span><span class="o">:</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">-&gt;</span> 
      <span class="nx">configFeature</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">getConfigFeature</span> <span class="nx">name</span> 
      <span class="k">if</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="o">!=</span> <span class="no">undefined</span> 
        <span class="nx">Plattform</span><span class="p">.</span><span class="na">executeFunctionByName</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> 
      <span class="k">else</span> 
        <span class="nx">configFeature</span><span class="p">.</span><span class="na">init</span> 

</code></pre>

<p></div></p>

  </div>
</div>
          <hr />
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          //<![CDATA[
                            var disqus_shortname = 'dev1cloudburo';
                    
              (function() {
                  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
          //]]>
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          <script type="text/javascript">
          //<![CDATA[
              var disqus_shortname = 'dev1cloudburo';
              (function () {
                  var s = document.createElement('script'); s.async = true;
                  s.type = 'text/javascript';
                  s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
              }());
          //]]>
          </script>
          
          <aside>
            <h3>
              Recent Articles
            </h3>
            <ol>
              <li>
                <a href="/2016/04/24/meteor-small-hints-3-passing-query-parameters-to-signup-route.html">Meteor Small Hints #3: Passing Query Parameters to Signup Route</a> <span>Apr 24</span> 
              </li>
              <li>
                <a href="/2016/04/21/meteor-small-hints-2-calling-local-methods-in-a-template.html">Meteor Small Hints #2: Calling local methods in a Template</a> <span>Apr 21</span> 
              </li>
              <li>
                <a href="/2016/03/04/rodrigue-schaefer-from-monolith-to-microservices-at-zalando.html">Rodrigue Schaefer : From monolith to microservices at Zalando</a> <span>Mar  4</span> 
              </li>
              <li>
                <a href="/2015/12/20/the-anatomy-of-a-eb-based-microservice-aws-security-configuration.html">The Anatomy of a EB based Microservice - AWS Security Configuration</a> <span>Dec 20</span> 
              </li>
              <li>
                <a href="/2015/11/15/problems-with-aws-cli-on-mac-osx-el-capitan.html">Problems with AWS CLI on Mac OSX El Capitan</a> <span>Nov 15</span> 
              </li>
              <li>
                <a href="/2015/11/07/dmarc-how-to-monitor-and-secure-your-email.html">DMARC: How to monitor and secure your email</a> <span>Nov  7</span> 
              </li>
              <li>
                <a href="/2015/10/03/meteor-small-hints-1-execute-a-function-by-name-which-works-on-client-and-server.html">Meteor Small Hints #1: Execute a function by name which works on client and server</a> <span>Oct  3</span> 
              </li>
              <li>
                <a href="/2015/10/01/micro-business-quick-tips-6-the-business-model-canvas-playground-for-free.html">Micro-Business Quick Tips #6 - The Business Model Canvas Playground for Free</a> <span>Oct  1</span> 
              </li>
              <li>
                <a href="/2015/10/01/micro-business-quick-tips-5-using-product-canvas-to-create-and-define-new-produc.html">Micro-Business Quick Tips #5 - Using Product Canvas to create and define new Products</a> <span>Oct  1</span> 
              </li>
              <li>
                <a href="/2015/09/30/micro-business-quick-tips-4-visualizing-your-business-model-with-canvas.html">Micro Business Quick Tips #4: Visualizing your Business Model with Canvas</a> <span>Sep 30</span> 
              </li>
            </ol>
          </aside>
          <hr>
            <p class="text-center">
              ©2016 <a href="/">dev@cloudburo</a> <br /><span class="small">Powered by<a href="https://cloudburo.net/docs/products.html"> Cloudburo Curation Engine</a></span>
            </p>
          </hr>
        </div>
        <div class="col-lg-3 col-md-3">
          <div class="well">
            <h4>
              Categories
            </h4>
            <ul class="list-unstyled">
              <li>
                <a href="/tags/api.html">api</a> (2)
              </li>
              <li>
                <a href="/tags/architecture.html">architecture</a> (9)
              </li>
              <li>
                <a href="/tags/aws.html">aws</a> (9)
              </li>
              <li>
                <a href="/tags/banking.html">banking</a> (1)
              </li>
              <li>
                <a href="/tags/bootstrap.html">bootstrap</a> (1)
              </li>
              <li>
                <a href="/tags/deutsch.html">deutsch</a> (1)
              </li>
              <li>
                <a href="/tags/docker.html">docker</a> (8)
              </li>
              <li>
                <a href="/tags/futurework.html">futureWork</a> (5)
              </li>
              <li>
                <a href="/tags/googleapps.html">googleapps</a> (1)
              </li>
              <li>
                <a href="/tags/gradle.html">gradle</a> (2)
              </li>
              <li>
                <a href="/tags/grails.html">grails</a> (2)
              </li>
              <li>
                <a href="/tags/inspiration.html">inspiration</a> (2)
              </li>
              <li>
                <a href="/tags/legal.html">legal</a> (1)
              </li>
              <li>
                <a href="/tags/meteor.html">meteor</a> (3)
              </li>
              <li>
                <a href="/tags/microservice.html">microservice</a> (12)
              </li>
              <li>
                <a href="/tags/modeling.html">modeling</a> (1)
              </li>
              <li>
                <a href="/tags/personaldata.html">personalData</a> (2)
              </li>
              <li>
                <a href="/tags/quicktips.html">quicktips</a> (12)
              </li>
              <li>
                <a href="/tags/shift.html">shift</a> (4)
              </li>
              <li>
                <a href="/tags/smallhints.html">smallhints</a> (13)
              </li>
              <li>
                <a href="/tags/startup.html">startup</a> (8)
              </li>
            </ul>
          </div>
          <div class="well">
            <h4>
              By year
            </h4>
            <ol>
              <li>
                <a href="/2016.html">2016</a> (3)
              </li>
              <li>
                <a href="/2015.html">2015</a> (37)
              </li>
              <li>
                <a href="/2014.html">2014</a> (10)
              </li>
            </ol>
          </div>
        </div>
      </div>
    </div>
    <script src="../../../js/all.js" type="text/javascript"></script>
  </body>
</html>