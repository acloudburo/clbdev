<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>dev@cloudburo | Meteor Small Hints #1: Execute a function by name which works on client and server</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><!--[if lt IE 9]><script src="../../../js/ie8.js"></script><![endif]--><link href="../../../css/all.css" rel="stylesheet" /><script type="text/javascript">
      (function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-35696879-1", location.hostname);ga("send","pageview");
    </script>
    <link href="/favicon.png" rel="icon" type="image/png" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
    <!--HTML5 shiv for IE8 support--><!--[if lt IE 9]
    | <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script-->
  </head>
  <body>
    <div class="col-sm-3 sidebar" id="secondary" style="display: none;">
      <aside>
        <div class="about">
          <h4>
            <a class="sidebarlink" href="/"><i class="fa fa-chevron-right"></i>    Home     <i class="fa fa-home"></i></a>
          </h4>
          <h4>
            <a class="sidebarlink" href="/menu1.html"><i class="fa fa-chevron-right"></i>    About   </a>
          </h4>
          <h4>
            <a class="sidebarlink" href="/menu2.html"><i class="fa fa-chevron-right"></i>    Contact   </a>
          </h4>
        </div>
        <div class="tags">
          <h4>
            Categories
          </h4>
          <ul class="list-unstyled">
            <a href="/tags/ai.html" class="label label-default">ai (2)</a>
            <a href="/tags/api.html" class="label label-default">api (2)</a>
            <a href="/tags/architecture.html" class="label label-default">architecture (26)</a>
            <a href="/tags/aws.html" class="label label-default">aws (13)</a>
            <a href="/tags/banking.html" class="label label-default">banking (6)</a>
            <a href="/tags/bigdata.html" class="label label-default">bigdata (2)</a>
            <a href="/tags/blockchain.html" class="label label-default">blockchain (17)</a>
            <a href="/tags/bots.html" class="label label-default">bots (2)</a>
            <a href="/tags/cloud.html" class="label label-default">cloud (3)</a>
            <a href="/tags/crypto.html" class="label label-default">crypto (2)</a>
            <a href="/tags/dao.html" class="label label-default">dao (1)</a>
            <a href="/tags/datascience.html" class="label label-default">datascience (3)</a>
            <a href="/tags/deutsch.html" class="label label-default">deutsch (1)</a>
            <a href="/tags/devops.html" class="label label-default">devops (1)</a>
            <a href="/tags/diagram.html" class="label label-default">diagram (1)</a>
            <a href="/tags/docker.html" class="label label-default">docker (10)</a>
            <a href="/tags/ethereum.html" class="label label-default">ethereum (3)</a>
            <a href="/tags/futurework.html" class="label label-default">futureWork (5)</a>
            <a href="/tags/gdpr.html" class="label label-default">gdpr (3)</a>
            <a href="/tags/googleapps.html" class="label label-default">googleapps (1)</a>
            <a href="/tags/gradle.html" class="label label-default">gradle (3)</a>
            <a href="/tags/identity.html" class="label label-default">identity (1)</a>
            <a href="/tags/inspiration.html" class="label label-default">inspiration (14)</a>
            <a href="/tags/intellij.html" class="label label-default">intellij (1)</a>
            <a href="/tags/javatutorial.html" class="label label-default">javatutorial (4)</a>
            <a href="/tags/journalism.html" class="label label-default">journalism (2)</a>
            <a href="/tags/legal.html" class="label label-default">legal (1)</a>
            <a href="/tags/marketing.html" class="label label-default">marketing (2)</a>
            <a href="/tags/meteor.html" class="label label-default">meteor (5)</a>
            <a href="/tags/microservice.html" class="label label-default">microservice (18)</a>
            <a href="/tags/ml.html" class="label label-default">ml (2)</a>
            <a href="/tags/modeling.html" class="label label-default">modeling (1)</a>
            <a href="/tags/personaldata.html" class="label label-default">personalData (5)</a>
            <a href="/tags/platform.html" class="label label-default">platform (2)</a>
            <a href="/tags/polkadot.html" class="label label-default">polkadot (6)</a>
            <a href="/tags/python.html" class="label label-default">python (6)</a>
            <a href="/tags/quicktips.html" class="label label-default">quicktips (18)</a>
            <a href="/tags/shift.html" class="label label-default">shift (4)</a>
            <a href="/tags/smallhints.html" class="label label-default">smallhints (13)</a>
            <a href="/tags/startup.html" class="label label-default">startup (11)</a>
            <a href="/tags/statistics.html" class="label label-default">statistics (1)</a>
            <a href="/tags/teambuilding.html" class="label label-default">teambuilding (2)</a>
            <a href="/tags/tut01.html" class="label label-default">tut01 (7)</a>
            <a href="/tags/tutorial.html" class="label label-default">tutorial (11)</a>
          </ul>
        </div>
        <div class="timeline">
          <h4>
            By year
          </h4>
          <ul class="list-unstyled">
            <a href="/2019.html" class="label label-primary">2019 (13)</a>
            <a href="/2018.html" class="label label-primary">2018 (33)</a>
            <a href="/2017.html" class="label label-primary">2017 (18)</a>
            <a href="/2016.html" class="label label-primary">2016 (16)</a>
            <a href="/2015.html" class="label label-primary">2015 (35)</a>
            <a href="/2014.html" class="label label-primary">2014 (10)</a>
          </ul>
        </div>
      </aside>
    </div>
    <!--/#secondary-->
    <div class="col-sm-12" id="primary">
      <div class="content">
        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              <a href="/">dev@cloudburo</a>
            </h1>
          </hgroup>
          <div class="btn btn-primary pull-right" id="togglesidebar">
            <i class="fa fa-bars"></i>
          </div>
        </header>
        <section class="post">
          <header class="entry-header">
            <h2 class="entry-title">
              <a href="/2015/10/03/meteor-small-hints-1-execute-a-function-by-name-which-works-on-client-and-server.html">Meteor Small Hints #1: Execute a function by name which works on client and server</a>
            </h2>
            <p class="entry-meta">
              Posted on  03.Oct 2015 | Tags <a class="label label-primary" href="/tags/smallhints.html">smallhints</a> <a class="label label-primary" href="/tags/meteor.html">meteor</a> 
            </p>
          </header>
          <div class="entry-description"><div class="row">
  <div class="article"><p><span/>      <div>
    Calling a function by name in Meteor gave me at the beginning some headache concerning the passed context. 
   <br> I.e.  the helper function which manages the 
   <i>function by name</i> execution, must work on the client, as well as server side, due to the fact that a Meteor method may be configured for both sides. 
   <br><br>
  </div> 
  <div>
    In my code I have a configuration object which has as an attribute initfunc, which defines a function which should be called in an initalization process. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight json"><code><span class="w">
  </span><span class="p">{</span><span class="w">  
       </span><span class="err">name</span><span class="p">:</span><span class="w"> </span><span class="err">'SiteName'</span><span class="w">  
       </span><span class="err">type:</span><span class="w"> </span><span class="err">'singleton'</span><span class="w"> 
       </span><span class="err">singletonSpace:</span><span class="w"> </span><span class="err">'sitename'</span><span class="w">  
       </span><span class="err">initfunc:</span><span class="w"> </span><span class="err">'Extension.getSiteName'</span><span class="w"> 
   </span><span class="p">}</span><span class="w"> 

</span></code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    The initfunc will be used in the following method call, e.g. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="na">getDefaultFeatureValue</span><span class="o">:</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">-&gt;</span> 
     <span class="nx">configFeature</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">getConfigFeature</span> <span class="nx">name</span> 
     <span class="k">if</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="o">!=</span> <span class="no">undefined</span> 
          <span class="nx">Plattform</span><span class="p">.</span><span class="na">executeFunctionByName</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="nb">window</span> 
     <span class="k">else</span> 
            <span class="nx">configFeature</span><span class="p">.</span><span class="na">init</span> 

</code></pre>

<div> 
   <div> 
    <br> 
   </div> 

<p></div> 
  <div>
    As one can see I pass to the executeFunctionByName the function name, as well as the global window variable as context. The execute function is looking like that. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="na">executeFunctionByName</span> <span class="o">:</span> <span class="p">(</span><span class="nx">functionName</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">-&gt;</span> 
       <span class="nx">args</span> <span class="o">=</span> <span class="na">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="na">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
       <span class="nx">namespaces</span> <span class="o">=</span> <span class="nx">functionName</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> 
       <span class="nx">func</span> <span class="o">=</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">pop</span><span class="p">()</span> 
       <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span> 
       <span class="k">while</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">length</span> 
              <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">namespaces</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> 
               <span class="nx">i</span><span class="o">++</span> 
       <span class="nx">value</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">func</span><span class="p">].</span><span class="na">apply</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">args</span> 
       <span class="k">return</span> <span class="nx">value</span> 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    Now this worked fine to the point where getDefaultFeatureValue was called from a server method as well. 
   <div> 
    <br> 
   </div> The problem was that the global variable window is only defined on the browser. The variable isn’t available in the NodeJS server part and you have to use the global variable. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="nx">Plattform</span><span class="p">.</span><span class="na">executeFunctionByName</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="nx">global</span> 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    I extended the code, so that the caller may not provide the context (in case he wants to call the function in a global context). The function itself will look then for a global context (the typeof code part in the beginning) 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
      <span class="na">executeFunctionByName</span> <span class="o">:</span> <span class="p">(</span><span class="nx">functionName</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="o">-&gt;</span> 
        <span class="k">if</span> <span class="k">typeof</span> <span class="nx">context</span> <span class="o">==</span> <span class="s">'undefined'</span> 
          <span class="k">if</span>  <span class="k">typeof</span> <span class="nx">global</span> <span class="o">==</span> <span class="s">'undefined'</span> 
            <span class="nx">context</span> <span class="o">=</span> <span class="nb">window</span> 
          <span class="k">else</span> 
            <span class="nx">context</span> <span class="o">=</span> <span class="nx">global</span> 
        <span class="nx">args</span> <span class="o">=</span> <span class="na">Array</span><span class="o">::</span><span class="nx">slice</span><span class="p">.</span><span class="na">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> 
        <span class="nx">namespaces</span> <span class="o">=</span> <span class="nx">functionName</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">'.'</span><span class="p">)</span> 
        <span class="nx">func</span> <span class="o">=</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">pop</span><span class="p">()</span> 
        <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span> 
        <span class="k">while</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">namespaces</span><span class="p">.</span><span class="na">length</span> 
          <span class="nx">context</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">namespaces</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> 
          <span class="nx">i</span><span class="o">++</span> 
        <span class="nx">value</span> <span class="o">=</span> <span class="nx">context</span><span class="p">[</span><span class="nx">func</span><span class="p">].</span><span class="na">apply</span> <span class="nx">context</span><span class="p">,</span> <span class="nx">args</span> 
        <span class="k">return</span> <span class="nx">value</span> 

</code></pre>

<div> 
   <br> 
  </div> 

<p><div>
    The final method was simplified not having to provide the global context. 
  </div> 
  <div> 
   <br> 
  </div> 
  <div></p>
<pre class="highlight coffeescript"><code>
  <span class="na">getDefaultFeatureValue</span><span class="o">:</span> <span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="o">-&gt;</span> 
      <span class="nx">configFeature</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="na">getConfigFeature</span> <span class="nx">name</span> 
      <span class="k">if</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> <span class="o">!=</span> <span class="no">undefined</span> 
        <span class="nx">Plattform</span><span class="p">.</span><span class="na">executeFunctionByName</span> <span class="nx">configFeature</span><span class="p">.</span><span class="na">initfunc</span> 
      <span class="k">else</span> 
        <span class="nx">configFeature</span><span class="p">.</span><span class="na">init</span> 

</code></pre>

<p></div></p>

  </div>
</div>
          </div>
          <div class="comments">
            <div id="disqus_thread">
              <div id="disqus_thread"></div>
              <script type="text/javascript">
              //<![CDATA[
                                var disqus_shortname = 'dev1cloudburo';
                        
                  (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
              //]]>
              </script>
              <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
              <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
              
              <script type="text/javascript">
              //<![CDATA[
                  var disqus_shortname = 'dev1cloudburo';
                  (function () {
                      var s = document.createElement('script'); s.async = true;
                      s.type = 'text/javascript';
                      s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                  }());
              //]]>
              </script>
              
            </div>
          </div>
        </section><footer class="footer">
          <p>
          </p>
          <div class="socials-footer"><a href="https://twitter.com/talfco" class="btn btn-twitter">
                <i class="fa fa-twitter"></i></a><a href="https://www.facebook.com/Cloudburonet-897759390318816/" class="btn btn-facebook">
                <i class="fa fa-facebook"></i></a><a href="https://plus.google.com/u/1/b/102868953630532463137/+CloudburoCh/posts" class="btn btn-google-plus">
                <i class="fa fa-google-plus"></i></a><a href="https://www.linkedin.com/in/felixk" class="btn btn-linkedin">
                <i class="fa fa-linkedin"></i></a><a href="https://github.com/talfco" class="btn btn-github">
                <i class="fa fa-github"></i></a>
          </div>
          <p>
            © 2019 All rights reserved 
          </p>
        </footer>
      </div>
    </div>
    <script src="../../../js/all.js"></script>
  </body>
</html>