<!doctype html> 
<html>
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>dev@cloudburo</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><!--[if lt IE 9]><script src="../../js/ie8.js" type="text/javascript"></script><![endif]--><link href="../../css/all.css" media="screen" rel="stylesheet" type="text/css" /><script type="text/javascript">
      (function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-35696879-1", location.hostname);ga("send","pageview");
    </script>
    <link href="/favicon.png" rel="icon" type="image/png" />
  </head>
  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button class="navbar-toggle collapsed" data-target=".navbar-ex1-collapse" data-toggle="collapse" type="button"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/">dev@cloudburo</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="/menu1.html"> About  </a>
            </li>
            <li>
              <a href="/menu2.html"> Contact  </a>
            </li>
            <li class="dropdown">
              <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">Categories <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li>
                  <a href="/tags/api.html">api (2)</a>
                </li>
                <li>
                  <a href="/tags/architecture.html">architecture (10)</a>
                </li>
                <li>
                  <a href="/tags/aws.html">aws (10)</a>
                </li>
                <li>
                  <a href="/tags/banking.html">banking (1)</a>
                </li>
                <li>
                  <a href="/tags/blockchain.html">blockchain (1)</a>
                </li>
                <li>
                  <a href="/tags/bootstrap.html">bootstrap (1)</a>
                </li>
                <li>
                  <a href="/tags/bots.html">bots (1)</a>
                </li>
                <li>
                  <a href="/tags/deutsch.html">deutsch (1)</a>
                </li>
                <li>
                  <a href="/tags/docker.html">docker (9)</a>
                </li>
                <li>
                  <a href="/tags/futurework.html">futureWork (5)</a>
                </li>
                <li>
                  <a href="/tags/googleapps.html">googleapps (1)</a>
                </li>
                <li>
                  <a href="/tags/gradle.html">gradle (2)</a>
                </li>
                <li>
                  <a href="/tags/inspiration.html">inspiration (2)</a>
                </li>
                <li>
                  <a href="/tags/legal.html">legal (1)</a>
                </li>
                <li>
                  <a href="/tags/meteor.html">meteor (5)</a>
                </li>
                <li>
                  <a href="/tags/microservice.html">microservice (12)</a>
                </li>
                <li>
                  <a href="/tags/modeling.html">modeling (1)</a>
                </li>
                <li>
                  <a href="/tags/personaldata.html">personalData (2)</a>
                </li>
                <li>
                  <a href="/tags/quicktips.html">quicktips (12)</a>
                </li>
                <li>
                  <a href="/tags/shift.html">shift (4)</a>
                </li>
                <li>
                  <a href="/tags/smallhints.html">smallhints (13)</a>
                </li>
                <li>
                  <a href="/tags/startup.html">startup (9)</a>
                </li>
              </ul>
            </li>
            <li class="dropdown">
              <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">By Year <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li>
                  <a href="/2016.html">2016 (9)</a>
                </li>
                <li>
                  <a href="/2015.html">2015 (35)</a>
                </li>
                <li>
                  <a href="/2014.html">2014 (10)</a>
                </li>
              </ul>
            </li>
            <ul class="list-unstyled list-inline nav navbar-nav navbar-right"></ul>
            <li><a href="https://twitter.com/talfco">
                        <i class="fa fa-lg fa-inverse fa-twitter-square"></i></a>
            </li>
            <li><a href="https://plus.google.com/u/1/b/102868953630532463137/+CloudburoCh/posts">
                        <i class="fa fa-lg fa-inverse fa-google-plus-square"></i></a>
            </li>
            <li><a href="https://www.linkedin.com/in/felixk">
                        <i class="fa fa-lg fa-inverse fa-linkedin-square"></i></a>
            </li>
            <li><a href="https://github.com/talfco">
                        <i class="fa fa-lg fa-inverse fa-github-square"></i></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row">
        <div class="col-lg-12 col-md-12">
          <h2>
            Table of Content
          </h2>
          <ul>
          <li>
          <a href="#introduction">Introduction</a>
          <ul>
          <li>
          <a href="#terminology-and-abbreviation">Terminology and Abbreviation</a>
          </li>
          <li>
          <a href="#framework-and-technologies-used">Framework and Technologies used</a>
          <ul>
          <li>
          <a href="#bootstrap">Bootstrap</a>
          </li>
          <li>
          <a href="#backbone">Backbone</a>
          </li>
          <li>
          <a href="#backbone.modelbinder">Backbone.ModelBinder</a>
          </li>
          <li>
          <a href="#stitch">Stitch</a>
          </li>
          </ul>
          </li>
          </ul>
          </li>
          <li>
          <a href="#main-class:-app">Main Class: App</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#step-1:-retrieve-the-main-page-template">Step 1: Retrieve the main page template</a>
          <ul>
          <li>
          <a href="#main-configuration-structure-and-caching">Main Configuration Structure and Caching</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#event-overview">Event Overview</a>
          <ul>
          <li>
          <a href="#event:-browser-url-change">Event: Browser URL Change</a>
          <ul>
          <li>
          <a href="#pub-1:-browser.urlopening">Pub 1: Browser.urlOpening</a>
          </li>
          <li>
          <a href="#pub-2:-basemenuview.tabmenuchange">Pub 2: BaseMenuView.tabMenuChange</a>
          </li>
          <li>
          <a href="#pub-3:-rootview.deleterecord">Pub 3: RootView.deleteRecord</a>
          </li>
          <li>
          <a href="#pub-4:-rootview.cancel">Pub 4: RootView.cancel</a>
          </li>
          <li>
          <a href="#consumer-1:-approuter.routes">Consumer 1: Approuter.routes</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#event:-menutabentryclick">Event: MenuTabEntryClick</a>
          <ul>
          <li>
          <a href="#pub-1:-basemenuview.mouseclick">Pub 1: BaseMenuView.mouseClick</a>
          </li>
          <li>
          <a href="#sub-1:-basemenu.view">Sub 1: BaseMenu.&lt;CRUD&gt;View</a>
          </li>
          <li>
          <a href="#sub-2:-basemenu.switchmenutab">Sub 2: BaseMenu.switchMenuTab</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#event:-changebusinessobjectscope">Event: ChangeBusinessObjectScope</a>
          <ul>
          <li>
          <a href="#pub-1:-baserouter.builddetailview">Pub 1: BaseRouter.buildDetailView</a>
          </li>
          <li>
          <a href="#sub-1:-basemenuview.changebusinessobjectscope">Sub 1: BaseMenuView.changeBusinessObjectScope</a>
          </li>
          <li>
          <a href="#sub-2:-tabmenuview.changebusinessobjectscope">Sub 2: TabMenuView.changeBusinessObjectScope</a>
          </li>
          <li>
          <a href="#sub-3:-navbarmenuview.changebusinessobjectscope">Sub 3: NavbarMenuView.changeBusinessObjectScope</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#event:-changebusinessobjectelement">Event: ChangeBusinessObjectElement</a>
          <ul>
          <li>
          <a href="#pub-1:-baserouter.builddetailview">Pub 1: BaseRouter.buildDetailView</a>
          </li>
          <li>
          <a href="#pub-2:-rootview.savetomodel">Pub 2: RootView.saveToModel</a>
          </li>
          <li>
          <a href="#pub-3:-rootlistitemview.click">Pub 3: RootListItemView.click</a>
          </li>
          <li>
          <a href="#sub-1:-rootview.changemodel">Sub 1: RootView.changeModel</a>
          </li>
          <li>
          <a href="#sub-2:-rootlistview.changemodel">Sub 2: RootListView.changeModel</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#event:-currentviewstate">Event: CurrentViewState</a>
          <ul>
          <li>
          <a href="#pub-1:-basemenuview.modifclick">Pub 1: BaseMenuView.modifClick</a>
          </li>
          <li>
          <a href="#sub-1:-rootview.currentviewstateevent">Sub 1: rootView.currentViewStateEvent</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#event:-changecontenttab">Event: changeContentTab</a>
          <ul>
          <li>
          <a href="#pub-1:-rootview.render">Pub 1: RootView.render</a>
          </li>
          <li>
          <a href="#sub-1:-rootview.changecontenttab">Sub 1: RootView.changeContentTab</a>
          </li>
          </ul>
          </li>
          </ul>
          </li>
          <li>
          <a href="#class-approuter">Class AppRouter</a>
          <ul>
          <li>
          <a href="#newinstance-(caching-of-views-and-models)">newInstance (caching of Views and Models)</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#views">Views</a>
          <ul>
          <li>
          <a href="#main-dropdown-menu-and-iconbar">Main Dropdown Menu and Iconbar</a>
          <ul>
          <li>
          <a href="#dropdown-templates">Dropdown Templates</a>
          </li>
          <li>
          <a href="#standardized-trigger-points">Standardized Trigger Points</a>
          </li>
          </ul>
          </li>
          <li>
          <a href="#main-view:-rootview-class">Main View: RootView class</a>
          <ul>
          <li>
          <a href="#trigger-events-and-cached-views">Trigger Events and cached Views</a>
          </li>
          <li>
          <a href="#event:-eventchangemodel">Event: eventChangeModel</a>
          </li>
          </ul>
          </li>
          </ul>
          </li>
          <li>
          <a href="#helpful-utilities">Helpful Utilities</a>
          <h2>Introduction</h2>

<p>As outlined above the main functionality of the Cloudburo App Platform will run as a Javascript based application in the browser of the end user. An is using the based on the following javascript frameworks and libraries.</p>

<h3>Terminology and Abbreviation</h3>

<p>The following terms and abbreviations will be used </p>

<ul>
<li>Business Domain Object (<em>BDO</em>) describes the main entities which are managed within the application, as for example a <em>customer</em>, an <em>employee</em>, a <em>course</em> etc.<br></li>
</ul>

<h3>Framework and Technologies used</h3>

<h4>Bootstrap</h4>

<p>The Cloudburo App Platform is based on the open sourced and incredible powerful front-end framework <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter</a>, which handles all the user interface related aspects as for example styles (CSS), user interface components (tool tips, popovers, tabs, alerts, page header), javascript plugins and so on. </p>

<h4>Backbone</h4>

<p><a href="http://documentcloud.github.com/backbone/">Backbone</a> is a great platform for writing client side applications. Backbone.js gives structure to web applications by providing models with key-value binding and custom events, collections with a rich API of enumerable functions, views with declarative event handling, and connects it all to your existing API over a RESTful JSON interface. It&rsquo;s one of the cornerstone client side libraries used in the Cloudburo App Platform.</p>

<h4>Backbone.ModelBinder</h4>

<p>The <a href="https://github.com/theironcook/Backbone.ModelBinder">Bacbkbone.ModelBinder</a> class is a great utility in order to bind backbone model attributes to:</p>

<ul>
<li>Read-only html elements such as <code>&lt;span&gt;</code>, <code>&lt;div&gt;</code> etc.</li>
<li>Html element attributes such as enabled, displayed, style etc.</li>
<li>Editable form elements such as <code>&lt;input&gt;</code>, <code>&lt;textarea&gt;</code> etc. </li>
<li>This type of binding is bidirectional between the html elements and the Model&rsquo;s attributes.</li>
</ul>

<p>As the creator and github user theironcook described</p>

<blockquote>
<p>The ModelBinder class helped me remove a lot of cluttered boilerplate code that existed to synchronize my models and views. As my application became more asynchronous, the ModelBinder saves me from a lot of pain by automatically displaying model attributes in the view as they are asynchronously loaded. Hopefully you&rsquo;ll find the ModelBinder useful too.</p>
</blockquote>

<p>It&rsquo;s very useful and I used it to manage all my input forms in a generic way (more later).</p>

<h4>Stitch</h4>

<p>The <a href="https://github.com/sstephenson/stitch">Stitch</a> Package Creator, which will bundle all Javascript Libraries in one file <code>application.js</code> and creates an <code>App</code> class which will be instantiated in the browser window after the HTML is loaded.</p>

<p>Looking in a browser window at the source html of the Cloudburo App Platform you will see only a minimal HTML document below 20 lines of code:  </p>

<pre><code class="html">&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=utf-8&gt;
    &lt;title&gt;Cloudburo App Center&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/application.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/bootstrap.css&quot;&gt;
        &lt;script src=&quot;/application.js&quot; type=&quot;text/javascript&quot; charset=&quot;utf-8&quot; /&gt;
        &lt;script type=&quot;text/javascript&quot; charset=&quot;utf-8&quot;&gt;
          document.addEventListener(&quot;DOMContentLoaded&quot;, 
            function(){ (require(&quot;app&quot;)).init();}, 
            false
          );
        &lt;/script&gt;
    &lt;/script&gt;
&lt;/head&gt;
    &lt;body&gt;&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>So the complete control is handed over to the javascript <em>App</em> application, after this minimal HTML is loaded in the browser window (includes the download of the application javascript code).</p>

<h2>Main Class: App</h2>

<p>As described above the <code>App</code>class is the main class which instantiates the overall application. </p>

<ul>
<li>It contains a global variable <em>BusinessObjectDef</em> which defines main configuration of <em>BDOs</em> available to the end user.</li>
<li>It will load the main application template (application skeleton) and generates the corresponding HTML content.</li>
<li>It will attach Backbone Views for the <code>MainTabMenuView</code> and the <code>IconbarView</code></li>
<li>It will instantiate the <code>AppRouter</code> (a Backbone Router) and delegates the control to it.</li>
</ul>

<pre><code class="coffeescript"># Step 1: Retrieve the main page template 
$.get &quot;/views/templates/main.show&quot;, (data) =&gt; 
    $(&#39;body&#39;).append(data) 
    tmpl =   document.getElementById(&#39;tmpl_mainpage&#39;).firstChild
    tmpl1 = _und.template tmpl.textContent
    $(&quot;body&quot;).append tmpl1
      &#39;home&#39; : &#39;Home&#39;, 
      &#39;home_person&#39; : &#39;Person&#39;, 
      &#39;home_account&#39; : &#39;Account&#39;
      &#39;home_profile&#39; : &#39;Profile&#39;
      &#39;search&#39; : &#39;Search&#39;, 
      &#39;help&#39; : &#39;Help&#39;, 
      &#39;help_manual&#39; : &#39;Online Manual&#39;
      &#39;help_faq&#39; : &#39;FAQ&#39;
      &#39;help_support&#39; : &#39;Support Request&#39;    


    TabMenuView = require(&quot;views/base/tabMenuView&quot;)
    tabMenuView = new TabMenuView 
    tabMenuView.render()

    IconbarView = require(&quot;views/base/iconbarView&quot;)
    iconbarView = new IconbarView 
    iconbarView.render()

    AppRouter = require(&quot;./appRouter&quot;)
    window.appRouter = new AppRouter()
    window.app = this;
    Backbone.history.start();
</code></pre>

<h3>Main Configuration Structure and Caching</h3>

<p>The global variable <code>window.BusinessObjectDef</code> defines the overall configuration of the application concerning available <em>BDO&rsquo;s</em> to the end user.</p>

<pre><code class="coffeescript">window.BusinessObjectDef =
    customers :
      mainRoute: &quot;customers&quot;  
      dialogAttr1: &quot;surname&quot; 
      dialogAttr2: &quot;name&quot;
    servicetemplates:
      mainRoute: &quot;serviceTemplates&quot;
      dialogAttr1: &quot;name&quot;
      dialogAttr2: &quot;&quot;
</code></pre>

<p>In the example above the application will offer the <em>BDO</em> types <em>customers</em> and <em>serviceTemplates</em>.</p>

<p>In the final version the assembly of <em>BDO</em> types offered to a customer will be dependent on the subscription level. </p>

<p>The <code>App</code>class will hold a global cache variable <code>window.cache = new Array()</code> which will cache Backbone models or views already opened and used during a user session.</p>

<h2>Event Overview</h2>

<h3>Event: Browser URL Change</h3>

<p>This event can be either triggered manually by user typing in an URL in the broweser window or by calling the <code>window.appRouter.navigate</code>operation, which is an instantiation of the Backbone Router class (holding all routes of the application.)  </p>

<h4>Pub 1: Browser.urlOpening</h4>

<p>Entering a browser URL in the form of</p>

<p><code>http://cloudburo.ch/#customers</code></p>

<p>and hitting return, will trigger the AppRouter dispatcher.</p>

<h4>Pub 2: BaseMenuView.tabMenuChange</h4>

<p>This event will be triggered in case the user wants to work with another <em>BDO</em> type (e.g. working with the domain objects <code>user</code>instead of <code>customer</code>). That means the detail view, as well as the list view will be switched. </p>

<p>This event is triggered for example when he clicks on a menu tab (<code>customer</code>or <code>user</code>) or any other icon associated via a <em>BDO</em> type.</p>

<p>This will trigger a <code>window.appRouter.navigate</code> operation (details refer to <a href="#anchor1">link</a>)</p>

<h4>Pub 3: RootView.deleteRecord</h4>

<p>When a record is deleted the view is refreshed by calling
<code>window.appRouter.navigate @viewNameL , {trigger: true}</code></p>

<h4>Pub 4: RootView.cancel</h4>

<p>When a cancel button is pressed and no previous entry is available.</p>

<h4>Consumer 1: Approuter.routes</h4>

<p>Our <code>AppRouter</code>class is derived from the <code>Backbone.Router</code>and is responsible to dispatch navigation changes which are reflected in the URL.</p>

<p>A navigation change is either happening when the user types a URL into the browser and hits return oder programmatically in our javascript application, e.g. by a menu tab click event (see above).</p>

<p>Refer to the following registered URL:</p>

<pre><code class="javascript">routes:
     &quot;&quot;                         : &quot;root&quot; 
     &quot;customers&quot;                    : &quot;listCustomer&quot;
     &quot;customers/&quot;               : &quot;listCustomer&quot;
     &quot;customers/:id&quot;                : &quot;detailCustomer&quot;
     &quot;customers/:id/modify&quot;     : &quot;modifyCustomer&quot;
     &quot;servicetemplates&quot;         : &quot;listServiceTemplate&quot;
     &quot;servicetemplates/&quot;            : &quot;listServiceTemplate&quot;
     &quot;servicetemplates/:id&quot;     : &quot;detailServiceTemplate&quot;
     &quot;servicetemplates/:id/modify&quot;: &quot;modifyServiceTemplate&quot;
</code></pre>

<p>Now each triggering of an operation will result in an action similiar like</p>

<pre><code class="javascript">listCustomer: -&gt;
      log.info &quot;AppRouter.listCustomer&quot;
      @switchBusinessObjectEvent &quot;customers&quot;
      @renderListView(&quot;Customer&quot;)

  detailCustomer: (id) -&gt;
      @switchBusinessObjectEvent &quot;customers&quot;
      log.info &quot;Approuter.detailCustomer: /customers/id called with id &#39;&quot;+id+&quot;&#39;&quot;
      @renderDetailView(&quot;Customer&quot;,id,window.viewStateView )
</code></pre>

<p>The <code>Approuter.switchBusinessObject</code>operation will be call by routes operation and do the following step:</p>

<ul>
<li> Will check if the <em>BDO</em> template is already loaded, if not it will load it now (= lazy loading in order to reduce size of initial page build up)</li>
<li> Will trigger the <code>currentBusinessObject</code> event notifying other components that the <em>BDO</em> were changed and the views replaced.</li>
</ul>

<p>The code looks like:</p>

<pre><code class="javascript">switchBusinessObjectEvent : (busObj) =&gt; 
      busObjShort = busObj.substring(0,busObj.length-1)
      if $(&quot;#tmpl_&quot;+busObjShort+&quot;_contentsheet&quot;).size() == 0
        $.get &quot;/views/templates/&quot;+busObj+&quot;.show&quot;, (data1) =&gt; 
          log.debug &quot;Approuter.switchBusinessObjectEvent: Template loaded&quot;
          $(&#39;body&#39;).append(data1)
          window.Notifier.trigger(window.Notifier.eventCurrentBusinessObject, busObj)  
      else
        window.Notifier.trigger(window.Notifier.eventCurrentBusinessObject, busObj) 
</code></pre>

<p>For more details refert to <a href="#anchor2">link</a>  </p>

<h3>Event: MenuTabEntryClick</h3>

<h4>Pub 1: BaseMenuView.mouseClick</h4>

<p>The <code>BaseMenuView</code>class (<code>views/base/baseMenuView.coffee</code>) installs click listeners which will be triggered in case the user clicks on <code>&lt;a&gt;</code>element in the menu or icon bar <a href="#anchor3">more details</a>. </p>

<pre><code class="coffeescript">events:
&#39;click #cuh&#39;: &#39;switchMenuTab&#39;
    &#39;click #cuo&#39;: &#39;showView&#39;
    &#39;click #cum&#39;: &#39;modifyView&#39;
    &#39;click #cun&#39;: &#39;newView&#39;
    &#39;click #cud&#39;: &#39;deleteView&#39;
    &#39;click #cuc&#39;: &#39;copyView&#39; 
    &#39;click #cup&#39;: &#39;printView&#39;
</code></pre>

<p>The <code>BaseMenuView</code> is a actually the parent class of <code>TabMenuView</code> class, as well as the <code>IconMenuView</code> class. The icon bar will provide the same click functionality as the tab menu (<code>cum-cuh</code>). </p>

<p><img src="/images/menuAndIconView.png" alt="TabMenuView and IconMenuView"></p>

<h4>Sub 1: BaseMenu.<CRUD>View</h4>

<p>The main functionality of the <code>BaseMenuView</code> operations are to trigger a global view state event upon which consumers may react.</p>

<pre><code class="coffeescript">showView: -&gt; 
    log.debug &quot;BaseMenuView.showView&quot;
    window.Notifier.trigger window.Notifier.eventCurrentViewState, window.viewStateView
    @postClickProcessing()
    return false

modifyView: -&gt;
    log.debug &quot;BaseMenuView.modifyView&quot;
    window.Notifier.trigger window.Notifier.eventCurrentViewState, window.viewStateModify
    @postClickProcessing()
    return false
</code></pre>

<p>The <code>postClickProcessing</code>operation does by default nothing but may overwritten by a inherited class, e.g. the <code>TabMenuView</code>class is overwriting this class in order to close the drop down menu again</p>

<pre><code class="coffeescript">postClickProcessing: -&gt;
    log.debug  &quot;TabMenuView.postClickProcessing&quot; , @busObj
    $(&#39;li[class~=&quot;open&quot;]&#39;).removeClass &#39;open&#39;
</code></pre>

<h4>Sub 2: <a href="id:anchor1">BaseMenu.switchMenuTab</a></h4>

<p>A special case is the <code>switchMenuTab</code> operation, which handles the event when user clicks on a tab mennu entry (drop down menu is closed)</p>

<pre><code class="coffeescript">switchMenuTab: (event )-&gt;
    a = event.target.parentElement.getAttribute(&quot;id&quot;)
    bobj = a.substring(0,a.length-3)
    log.debug &#39;BaseMenuView.switchMenuTab: &quot;&#39;+bobj+&#39;&quot; current scope on &quot;&#39;+@busObj+&#39;&quot;&#39;
    if bobj != @busObj
        @busObj = bobj
        window.appRouter.navigate(&quot;/&quot;+@busObj,{trigger: true})
</code></pre>

<ul>
<li>The operation will identify the <em>BDO</em> selected by querying the dropdown id <code>&lt;li id=&quot;servicetemplates-dp&quot; class=&quot;dropdown&quot;&gt;</code> and by getting rid of the last three characters. </li>
<li>It will check if the clicked tab is already selected (stored in the class varialble <code>@busObj</code>) if not the <code>AppRouter.navigate</code> operation will be called.</li>
</ul>

<h3>Event: ChangeBusinessObjectScope</h3>

<p>Even which will triggered in case the Business Object scope will change, i.e. the user changes from the business object &lsquo;customer&rsquo; to the &lsquo;order&rsquo; one. As well as a initial Browser opening with a specific URL.</p>

<h4>Pub 1: BaseRouter.buildDetailView</h4>

<p>See above this event will be triggered as a result of a of renderDetailView request originiated by the <code>switchMenutTab</code> or a browser opening with a specific URL. </p>

<h4>Sub 1: BaseMenuView.changeBusinessObjectScope</h4>

<p>Will consume the event. In case the passed in business object domain type is different the menu tab must be adjusted. </p>

<h4>Sub 2: TabMenuView.changeBusinessObjectScope</h4>

<p>Extends the <code>BaseMenuView</code> will control the toggling of TabMenu entries (on/off)</p>

<h4>Sub 3: NavbarMenuView.changeBusinessObjectScope</h4>

<p>The navigation bar holds the search input field, which has a selection dropdown attached which allows to select the search field. Dependent on the business object domain type shown on the screen (in the example below the <code>Customer</code>) the drop down selection values will be adjusted accordingly.</p>

<p><img src="/images/Voila_Capture320.png" alt="TabMenuView and IconMenuView"></p>

<h3>Event: ChangeBusinessObjectElement</h3>

<p>Will be triggered in case the detail view model was changed to a new one. This can be either triggered by</p>

<ol>
<li>A <code>changeBusinessScope</code> event happened beforehand due to a initial browser window opening or the user changed scope via menu or tab change</li>
<li> The user selected another element in the list view</li>
<li> The user saved a new element in modify view</li>
</ol>

<h4>Pub 1: BaseRouter.buildDetailView</h4>

<p>Will handle the constellation 1 and 2 of the above event triggering.</p>

<h4>Pub 2: RootView.saveToModel</h4>

<p>Will handle constellation 3 of the above event triggering. This is method will also triggering the <code>eventCurrentViewState</code> </p>

<h4>Pub 3: RootListItemView.click</h4>

<p>Will be triggered in case the user clicks on a list entry in the List View. The Event Trigger is configurable (<code>RootListItemView</code>is used in multiple list view) and passed in during creation of a list item.</p>

<h4>Sub 1: RootView.changeModel</h4>

<p>The operation <code>changeModel</code> will be triggered, which will check if the passed in target model has to be replaced or not and takes over kicks off rendering part.</p>

<h4>Sub 2: RootListView.changeModel</h4>

<p>The operation <code>changeModel</code> will be triggered which will highlight the entry. the Event Trigger is configurable  and passed in during creation of a list item. Analogue to the publishing even above on <code>RootListItemView</code>.</p>

<h3>Event: CurrentViewState</h3>

<h4>Pub 1: BaseMenuView.modifClick</h4>

<p>If the user selects the modify entry or new entry the event will be triggered</p>

<h4>Sub 1: rootView.currentViewStateEvent</h4>

<p>Depending on the state will close and reopen the view</p>

<pre><code class="javascript">currentViewStateEvent: (viewState) =&gt;
    log.debug &quot;RootView.currentViewStateEvent &quot;+@state+&quot; - &quot;+viewState
    if @state != viewState
      @state = viewState 
      @close()
      @render()
</code></pre>

<h3>Event: changeContentTab</h3>

<p>Will be triggered when the the content tabs in a view are changed (i.e. the so-called pill list)</p>

<h4>Pub 1: RootView.render</h4>

<p>The rendering of the root view  will trigger the event</p>

<h4>Sub 1: RootView.changeContentTab</h4>

<p>The operation will toggle the content tabs.</p>

<h2><a href="id:anchor2">Class AppRouter</a></h2>

<p>The <code>AppRouter</code>class provides a set of functions to manage and rendering the Views of the application, theres are </p>

<ul>
<li><code>newInstance</code></li>
<li><code>renderViews</code></li>
<li><code>renderListView</code></li>
<li><code>renderDetailView</code></li>
</ul>

<h3>newInstance (caching of Views and Models)</h3>

<p>The newInstance is used for the creation of Views and Model and will make use of caching, i.e. any view/model already opened will be cached during the user sessions.</p>

<pre><code class="coffeescript">newInstance: (strClass) -&gt;
    # Let&#39;s cache the Views
    if window.cache[strClass] != undefined
      return window.cache[strClass]
    else  
      args = Array.prototype.slice.call arguments, 1 
      clsClass = eval strClass
      F = () -&gt; return clsClass.apply this, args
      F.prototype = clsClass.prototype
      window.cache[strClass] = new F()
      return window.cache[strClass]
</code></pre>

<h2>Views</h2>

<h3>Main Dropdown Menu and Iconbar</h3>

<p>The main dropdown menu will consist of a list of all <em>BDO&rsquo;s</em> with its associated functions. </p>

<h4>Dropdown Templates</h4>

<p>The menu part of each <em>BDO</em> is defined as part of the <code>views/templates/main.show.tpl</code>and consists of HTML fragments like</p>

<pre><code class="html">&lt;script type=&quot;text/template&quot; id=&quot;tmpl_customers_dropdownmenu&quot;&gt;
    &lt;li id=&quot;customers-dp&quot; class=&quot;dropdown&quot;&gt; 
    &lt;a id=&quot;cuh&quot; href=&quot;#&quot; class=&quot;dropdown-toggle&quot; data-toggle=&quot;dropdown&quot;&gt;&lt;%= customer_menu_header %&gt;&lt;b class=&quot;caret&quot;&gt;&lt;/b&gt;&lt;/a&gt; 
    &lt;ul class=&quot;dropdown-menu&quot;&gt; 
      &lt;li&gt;&lt;a id=&quot;cuo&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= customer_menu_overview %&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cun&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= customer_menu_new %&gt;&lt;/a&gt;&lt;/li&gt; 
      &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cum&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= customer_menu_modify %&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cud&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= customer_menu_delete %&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cup&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;/span&gt;&lt;%= customer_menu_print %&gt;&lt;/a&gt;&lt;/li&gt; 
    &lt;/ul&gt; 
  &lt;/li&gt;
&lt;/script&gt;
    &lt;script type=&quot;text/template&quot; id=&quot;tmpl_servicetemplates_dropdownmenu&quot;&gt;
    &lt;li id=&quot;servicetemplates-dp&quot; class=&quot;dropdown&quot;&gt; 
    &lt;a id=&quot;cuh&quot; href=&quot;#&quot; class=&quot;dropdown-toggle&quot; data-toggle=&quot;dropdown&quot;&gt;&lt;%= servicetemplate_menu_header %&gt;&lt;b class=&quot;caret&quot;&gt;&lt;/b&gt;&lt;/a&gt; 
    &lt;ul class=&quot;dropdown-menu&quot;&gt; 
      &lt;li&gt;&lt;a id=&quot;cuo&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= servicetemplate_menu_overview %&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cun&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= servicetemplate_menu_new %&gt;&lt;/a&gt;&lt;/li&gt; 
      &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cum&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= servicetemplate_menu_modify %&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cud&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;%= servicetemplate_menu_delete %&gt;&lt;/a&gt;&lt;/li&gt;
      &lt;li class=&quot;divider&quot;&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a id=&quot;cup&quot; href=&quot;&quot; data-toggle=&quot;tab&quot;&gt;&lt;/span&gt;&lt;%= servicetemplate_menu_print %&gt;&lt;/a&gt;&lt;/li&gt; 
    &lt;/ul&gt; 
  &lt;/li&gt;
&lt;/script&gt;
</code></pre>

<h4><a href="id:anchor3">Standardized Trigger Points</a></h4>

<p>Each of these fragment blocks are identifiable and loadable via the identifier <code>&lt;businessdomainobject&gt;s-dp</code>, e.g. <code>&lt;li id=&quot;customers-dp&quot; class=&quot;dropdown&quot;&gt; p</code>. There are predefined trigger points defined attached to the <code>&lt;a&gt;</code>element in the fragment.</p>

<p><img src="/images/menuTriggerpoints.png" alt="Menu Trigger Points"></p>

<ul>
<li><code>cuh</code>: Is the root trigger point for a tab switch, i.e. the current <em>BDO</em> screens will be replaced through the new one and the drop down menu will be displayed.</li>
<li><code>cuo</code>: Open Overview Screen, which shows a read only view of a dedicated <em>BDO</em> (the selected one, by defaul the first one) </li>
<li><code>cun</code>: New <em>BDO</em> Screen</li>
<li><code>cum</code>: Modify <em>BDO</em> Screen</li>
<li><code>cud</code>: Delete <em>BDO</em> Screen</li>
<li><code>cup</code>: Print <em>BDO</em> Screen</li>
</ul>

<h3>Main View: RootView class</h3>

<p>As described above the <code>BaseMenuView</code>class will get triggered in case the user wants to change the view state, for example to create, modify or delete a <em>BDO</em>. The class will trigger a global event in the form of <code>window.Notifier.trigger window.Notifier.eventNewRecord</code> which will be consumed by the <code>RootView</code>class in order to do the view state change.</p>

<h4>Trigger Events and cached Views</h4>

<p>It&rsquo;s important to mention that the application will cache view instances during a user session. That means in case the user will trigger a tab menu change the application will check in its cache if the view was already opened beforehand or not. In case the view was already used beforehand the cached instance will be visualized immediately (this handled in the <code>AppRout.newInstance</code> method). </p>

<p>In context of a event trigger based applications some special considerations must be taken. E.g. any view state change trigger event will be consumed by the actual visible view but also all the cached ones which are currently hidden, <em>BUT</em> only the visible view should react on the view state change. That means the view must know if he is the actual visible one or not. </p>

<p>This boolean information will be derived through  <code>window.Notifier.eventChangeModel</code> events which are consumed by <code>RootView</code>class as well.</p>

<h4>Event: eventChangeModel</h4>

<h2>Helpful Utilities</h2>

<p>Creating a object via reflection</p>

<pre><code class="javascript">newInstance: (strClass) -&gt;
      args = Array.prototype.slice.call arguments, 1 
      clsClass = eval strClass
      F = () -&gt; return clsClass.apply this, args
      F.prototype = clsClass.prototype
      return new F()
</code></pre>

<p>JavaScript lacks a built-in function for getting the exact class names of object instances. This function will retrieve the name via the constructor.</p>

<pre><code class="javascript">getObjectClass: (obj) -&gt;
    if (obj &amp;&amp; obj.constructor &amp;&amp; obj.constructor.toString) 
        arr = obj.constructor.toString().match(/function\s*(\w+)/);
        if (arr &amp;&amp; arr.length == 2) 
        return arr[1];
    return undefined;
</code></pre>
<hr>
            <p class="text-center">
              ©2016 <a href="/">dev@cloudburo</a> <br /><span class="small">Powered by<a href="https://cloudburo.net/docs/products.html"> Cloudburo Curation Engine</a></span>
            </p>
          </hr>
        </div>
      </div>
    </div>
    <script src="../../js/all.js" type="text/javascript"></script>
  </body>
</html>