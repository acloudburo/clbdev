<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" />
    <title>dev@cloudburo | Install  Letsencrypt  Certificate in the Java JDK Keystore on OSX</title>
    <meta content="width=device-width, initial-scale=1" name="viewport" />
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><!--[if lt IE 9]><script src="../../../js/ie8.js"></script><![endif]--><link href="../../../css/all.css" rel="stylesheet" /><script type="text/javascript">
      (function(d,e,j,h,f,c,b){d.GoogleAnalyticsObject=f;d[f]=d[f]||function(){(d[f].q=d[f].q||[]).push(arguments)},d[f].l=1*new Date();c=e.createElement(j),b=e.getElementsByTagName(j)[0];c.async=1;c.src=h;b.parentNode.insertBefore(c,b)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-35696879-1", location.hostname);ga("send","pageview");
    </script>
    <link href="/favicon.png" rel="icon" type="image/png" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro%3A400%2C400italic%2C700" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet" />
    <!--HTML5 shiv for IE8 support--><!--[if lt IE 9]
    | <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script-->
  </head>
  <body>
    <div class="col-sm-3 sidebar" id="secondary" style="display: none;">
      <aside>
        <div class="about">
          <h4>
            <a class="sidebarlink" href="/"><i class="fa fa-chevron-right"></i>    Home     <i class="fa fa-home"></i></a>
          </h4>
          <h4>
            <a class="sidebarlink" href="/menu1.html"><i class="fa fa-chevron-right"></i>    About   </a>
          </h4>
          <h4>
            <a class="sidebarlink" href="/menu2.html"><i class="fa fa-chevron-right"></i>    Contact   </a>
          </h4>
        </div>
        <div class="tags">
          <h4>
            Categories
          </h4>
          <ul class="list-unstyled">
            <a href="/tags/ai.html" class="label label-default">ai (2)</a>
            <a href="/tags/api.html" class="label label-default">api (2)</a>
            <a href="/tags/architecture.html" class="label label-default">architecture (26)</a>
            <a href="/tags/aws.html" class="label label-default">aws (13)</a>
            <a href="/tags/banking.html" class="label label-default">banking (6)</a>
            <a href="/tags/bigdata.html" class="label label-default">bigdata (1)</a>
            <a href="/tags/blockchain.html" class="label label-default">blockchain (15)</a>
            <a href="/tags/bots.html" class="label label-default">bots (2)</a>
            <a href="/tags/cloud.html" class="label label-default">cloud (3)</a>
            <a href="/tags/crypto.html" class="label label-default">crypto (1)</a>
            <a href="/tags/datascience.html" class="label label-default">datascience (3)</a>
            <a href="/tags/deutsch.html" class="label label-default">deutsch (1)</a>
            <a href="/tags/devops.html" class="label label-default">devops (1)</a>
            <a href="/tags/docker.html" class="label label-default">docker (10)</a>
            <a href="/tags/ethereum.html" class="label label-default">ethereum (1)</a>
            <a href="/tags/futurework.html" class="label label-default">futureWork (5)</a>
            <a href="/tags/gdpr.html" class="label label-default">gdpr (3)</a>
            <a href="/tags/googleapps.html" class="label label-default">googleapps (1)</a>
            <a href="/tags/gradle.html" class="label label-default">gradle (3)</a>
            <a href="/tags/identity.html" class="label label-default">identity (1)</a>
            <a href="/tags/inspiration.html" class="label label-default">inspiration (11)</a>
            <a href="/tags/intellij.html" class="label label-default">intellij (1)</a>
            <a href="/tags/javatutorial.html" class="label label-default">javatutorial (4)</a>
            <a href="/tags/legal.html" class="label label-default">legal (1)</a>
            <a href="/tags/marketing.html" class="label label-default">marketing (2)</a>
            <a href="/tags/meteor.html" class="label label-default">meteor (5)</a>
            <a href="/tags/microservice.html" class="label label-default">microservice (18)</a>
            <a href="/tags/ml.html" class="label label-default">ml (2)</a>
            <a href="/tags/modeling.html" class="label label-default">modeling (1)</a>
            <a href="/tags/personaldata.html" class="label label-default">personalData (4)</a>
            <a href="/tags/platform.html" class="label label-default">platform (2)</a>
            <a href="/tags/polkadot.html" class="label label-default">polkadot (4)</a>
            <a href="/tags/python.html" class="label label-default">python (1)</a>
            <a href="/tags/quicktips.html" class="label label-default">quicktips (17)</a>
            <a href="/tags/shift.html" class="label label-default">shift (4)</a>
            <a href="/tags/smallhints.html" class="label label-default">smallhints (13)</a>
            <a href="/tags/startup.html" class="label label-default">startup (11)</a>
            <a href="/tags/teambuilding.html" class="label label-default">teambuilding (2)</a>
            <a href="/tags/tutorial.html" class="label label-default">tutorial (6)</a>
          </ul>
        </div>
        <div class="timeline">
          <h4>
            By year
          </h4>
          <ul class="list-unstyled">
            <a href="/2018.html" class="label label-primary">2018 (29)</a>
            <a href="/2017.html" class="label label-primary">2017 (18)</a>
            <a href="/2016.html" class="label label-primary">2016 (16)</a>
            <a href="/2015.html" class="label label-primary">2015 (35)</a>
            <a href="/2014.html" class="label label-primary">2014 (10)</a>
          </ul>
        </div>
      </aside>
    </div>
    <!--/#secondary-->
    <div class="col-sm-12" id="primary">
      <div class="content">
        <header class="header">
          <hgroup class="pull-left">
            <h1 class="site-title">
              <a href="/">dev@cloudburo</a>
            </h1>
          </hgroup>
          <div class="btn btn-primary pull-right" id="togglesidebar">
            <i class="fa fa-bars"></i>
          </div>
        </header>
        <section class="post">
          <header class="entry-header">
            <h2 class="entry-title">
              <a href="/2018/06/03/install-letsencrypt-certificate-in-the-java-jdk-keystore-on-osx.html">Install  Letsencrypt  Certificate in the Java JDK Keystore on OSX</a>
            </h2>
            <p class="entry-meta">
              Posted on  03.Jun 2018 | Tags <a class="label label-primary" href="/tags/quicktips.html">quicktips</a> <a class="label label-primary" href="/tags/javatutorial.html">javatutorial</a> 
            </p>
          </header>
          <div class="entry-description"><div class="row">
  <div class="article"><p><span/>      <div>
    The following article gives a short introduction, how to import a root certificate into the Java JDK keystore on a Mac OSX. The example is based on the import of the
   <a href="https://letsencrypt.org/certificates/">ISRG Root X1 certificate</a>, which is a very new certificate and not broadly trusted yet. Actually they do a cross signing of their intermediate certificate with IdenTrust (which is already widely trusted) in order to relief this short-coming.
  </div>
  <div>
   <br>
  </div>
  <div>
    Anyway the import sequence may help you in case you want to install another certificate in a same way. 
  </div>
  <div>
   <br>
  </div>
  <div>
    Assumption is that we have SSLHandshake Exception due to the missing ISRG certificate. In my example a gradle build was failing due to missing certificate.
  </div>
  <div>
   <br>
  </div>
  <div></p>
<pre class="highlight shell"><code>
  Could not resolve all dependencies <span class="k">for </span>configuration <span class="s1">':compileClasspath'</span>. 
  &gt; Could not resolve com.aspose:aspose-cells:17.9. 
    Required by: 
        project : &gt; com.edorasware.one:edoras-one-starter:2.0.4 ... 
     &gt; Could not resolve com.aspose:aspose-cells:17.9. 
        &gt; Could not get resource <span class="s1">' https://artifact.aspose.com/repo/com/aspose/aspose-cells/17.9/aspose-cells-17.9.pom'</span>. 
           ... 
              &gt; sun.security.validator.ValidatorException: PKIX path building failed:  


  sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target 

</code></pre>

<div>
   <br>
  </div>

<p><div>
    The certificate of the
   <a href="http://aspose.com"><a href="https://aspose.com">https://aspose.com</a></a> repository is a Let’s Encrypt Authority X3, which is based on DST Root CA X3. You get the below window when you check the certificate of the site in the browser (Chrome screenshot)
  </div>
  <div>
   <br>
  </div>
  <div></p>

<p><img class='article  img-thumbnail' src='/images/983fa892a9ca8a1124351e1d82cffd92.png'></p>

  </div>
  <div class="article">
    <p><span/>         <br>
      </div>
      <div>
       <br>
      </div>
      <div>
        So we have to load the Let’s Encrypt certificates into the Java keystore<br>
       <span style="font-family: &quot;Courier New&quot;;">cacerts</span> on our machine, to make the certificate path accessible.
      </div>
      <div>
       <br>
      </div>
      <div>
        The whole signing setup is described here: 
       <a href="https://letsencrypt.org/certificates/"><a href="https://letsencrypt.org/certificates/">https://letsencrypt.org/certificates/</a></a> 
      </div>
      <div>
       <br>
      </div>
      <div></p>
    
    <p><img class='article  img-thumbnail' src='/images/776235a84f4a1c13ad3cf52b4df21ba3.png'></p>
    
  </div>
  <div class="article"><p><span/>         <br>
  </div>
  <div>
   <br>
  </div>
  <div>
   <br>
  </div>
  <div>
   <span style="font-weight: bold;">Step 1: Set-up JAVA_HOME and install wget</span>
  </div>
  <div>
   <br>
  </div>
  <div>
    First of all it’s advisable to set up the
   <span style="font-family: &quot;Courier New&quot;;">JAVA_HOME</span> correctly on your Mac OSX machine, by using the
   <span style="font-family: &quot;Courier New&quot;;">java_home</span> executable (
   <a href="https://stackoverflow.com/questions/1348842/what-should-i-set-java-home-to-on-osx">Stackoverflow</a>). Add the following to the .bash_profile 
  </div>
  <div>
   <br>
  </div>
  <div></p>
<pre class="highlight shell"><code>
  <span class="nb">export </span><span class="nv">JAVA_HOME</span><span class="o">=</span><span class="k">$(</span>/usr/libexec/java_home<span class="k">)</span> 

</code></pre>

<div>
   <br>
  </div>

<p><div>
    For running the import script we require
   <span style="font-family: &quot;Courier New&quot;;">wget</span>. Assuming you install OSX tools via
   <a href="https://brew.sh/" style="font-family: &quot;Courier New&quot;;">brew</a>
   <span style="font-family: &quot;Courier New&quot;;"> -</span> the so-called missing package manager for the Mac - run the following command
  </div>
  <div>
   <br>
  </div>
  <div></p>
<pre class="highlight shell"><code>
  brew install wget 

</code></pre>

<div>
   <br>
  </div>

<p><div>
   <span style="font-weight: bold;">Step 2: Do some keystore checks</span>
  </div>
  <div>
   <br>
  </div>
  <div>
    First of check if the ISRG certificate is already installed in your
   <span style="font-family: &quot;Courier New&quot;;">keystore</span>. The java JDK keystore can be found under the
   <span style="font-family: &quot;Courier New&quot;;">JAVA_HOME</span> directory in the following folder 
   <span style="font-family: &quot;Courier New&quot;;">jre/lib/security/cacerts</span>
  </div>
  <div>
   <br>
  </div>
  <div></p>
<pre class="highlight shell"><code>
  ~ felix&gt; keytool -v -list -keystore <span class="nv">$JAVA_HOME</span>/jre/lib/security/cacerts | grep ISRG 
  Enter keystore password:  changeit 

</code></pre>

<div>
   <br>
  </div>

<p><div>
   <span style="font-family: &quot;Courier New&quot;;">changeit</span> is the default password of the Java JDK installation. Nothing will be given back. As for example looking for existing certificate (i.e. the in this example the cross signing certificate of Digital Signature Trust Co.), will be shown.  By storing the full output in a file, provides you with an overview of all installed certificates in your Java JDK keystore.
  </div>
  <div>
   <br>
  </div>
  <div></p>
<pre class="highlight shell"><code>
  ~ felix&gt; keytool -v -list -keystore <span class="nv">$JAVA_HOME</span>/jre/lib/security/cacerts | grep DST 
  Enter keystore password:  changeit 
  Issuer: <span class="nv">CN</span><span class="o">=</span>DST Root CA X3, <span class="nv">O</span><span class="o">=</span>Digital Signature Trust Co. 
       <span class="o">[</span>URIName: http://crl.identrust.com/DSTROOTCAX3CRL.crl] 
  Issuer: <span class="nv">CN</span><span class="o">=</span>DST Root CA X3, <span class="nv">O</span><span class="o">=</span>Digital Signature Trust Co. 
       <span class="o">[</span>URIName: http://crl.identrust.com/DSTROOTCAX3CRL.crl] 
  Issuer: <span class="nv">CN</span><span class="o">=</span>DST Root CA X3, <span class="nv">O</span><span class="o">=</span>Digital Signature Trust Co. 
       <span class="o">[</span>URIName: http://crl.identrust.com/DSTROOTCAX3CRL.crl] 
  Issuer: <span class="nv">CN</span><span class="o">=</span>DST Root CA X3, <span class="nv">O</span><span class="o">=</span>Digital Signature Trust Co. 
       <span class="o">[</span>URIName: http://crl.identrust.com/DSTROOTCAX3CRL.crl] 

</code></pre>

<div>
   <br>
  </div>

<p><div>
    As we have seen, the certificate is missing, so let’s run the following script 
  </div>
  <div>
   <br>
  </div>
  <div>
   <span style="font-weight: bold;">Step 3: Run the import script</span>
  </div>
  <div>
   <br>
  </div>
  <div>
    The script will fetch from the
   <a href="http://letsencrypt.org">letsencrypt.org</a> web site the certificate information via
   <span style="font-family: &quot;Courier New&quot;;">wget</span> and adds it to the 
   <span style="font-family: &quot;Courier New&quot;;">cacerts</span> keystore via the
   <span style="font-family: &quot;Courier New&quot;;">keytool.</span>
  </div>
  <div>
   <br>
  </div>
  <div>
    You can find the script here: 
   <a href="https://gist.github.com/talfco/bf82709e0e2ee86ffef25dc38aad6844"><a href="https://gist.github.com/talfco/bf82709e0e2ee86ffef25dc38aad6844">https://gist.github.com/talfco/bf82709e0e2ee86ffef25dc38aad6844</a></a>
  </div>
  <div>
   <br>
  </div>
  <div></p>

<p><img class='article  img-thumbnail' src='/images/dec5f8f74d808230c2c66c152088b91f.png'></p>

  </div>
  <div class="article"><p><span/>         <br>
  </div>
  <div>
   <br>
  </div>
  <div>
    Run the script, which get all the necessary certificate artefacts  from the letsencrypt server and installs in your keystore. So script is based on the following
   <a href="https://gist.github.com/Firefishy/109b0f1a90156f6c933a50fe40aa777e">implementation</a> and described by
   <a href="https://community.letsencrypt.org/t/ssl-certs-in-java/15450">letsencrypt</a> here.
  </div>
  <div>
   <br>
  </div>
  <div>
   <br>
  </div>
  <div>
   <span style="font-weight: bold;">Step 4: Check the successful Import</span>
  </div>
  <div>
   <br>
  </div>
  <div>
    Run the list command once again, you will now get back result output
  </div>
  <div>
   <br>
  </div>
  <div></p>
<pre class="highlight shell"><code>
  ~ felix&gt; keytool -v -list -keystore <span class="nv">$JAVA_HOME</span>/jre/lib/security/cacerts | grep ISRG 
  Enter keystore password:  changeit 
  Issuer: <span class="nv">CN</span><span class="o">=</span>ISRG Root X1, <span class="nv">O</span><span class="o">=</span>Internet Security Research Group, <span class="nv">C</span><span class="o">=</span>US 
  Issuer: <span class="nv">CN</span><span class="o">=</span>ISRG Root X1, <span class="nv">O</span><span class="o">=</span>Internet Security Research Group, <span class="nv">C</span><span class="o">=</span>US 
  Issuer: <span class="nv">CN</span><span class="o">=</span>ISRG Root X1, <span class="nv">O</span><span class="o">=</span>Internet Security Research Group, <span class="nv">C</span><span class="o">=</span>US 

</code></pre>

<p></div>
  <div>
   <br>
  </div>
  <div>
    Retry you java application or build, which should now be executed.
  </div>
  <div>
   <br>
  </div>
  <div>
   <br>
  </div>
  <div>
   <span style="font-size: 11px; font-style: italic;">This blog entry was fully produced within Evernote and published using the </span>
   <a href="https://publishingbot.cloudburo.net" style="font-size: 11px; font-style: italic;">Cloudburo Publishing Bot</a>
   <span style="font-size: 11px; font-style: italic;">.</span>
  </div></p>

  </div>
</div>
          </div>
          <div class="comments">
            <div id="disqus_thread">
              <div id="disqus_thread"></div>
              <script type="text/javascript">
              //<![CDATA[
                                var disqus_shortname = 'dev1cloudburo';
                        
                  (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
              //]]>
              </script>
              <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
              <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
              
              <script type="text/javascript">
              //<![CDATA[
                  var disqus_shortname = 'dev1cloudburo';
                  (function () {
                      var s = document.createElement('script'); s.async = true;
                      s.type = 'text/javascript';
                      s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                  }());
              //]]>
              </script>
              
            </div>
          </div>
        </section><footer class="footer">
          <p>
          </p>
          <div class="socials-footer"><a href="https://twitter.com/talfco" class="btn btn-twitter">
                <i class="fa fa-twitter"></i></a><a href="https://www.facebook.com/Cloudburonet-897759390318816/" class="btn btn-facebook">
                <i class="fa fa-facebook"></i></a><a href="https://plus.google.com/u/1/b/102868953630532463137/+CloudburoCh/posts" class="btn btn-google-plus">
                <i class="fa fa-google-plus"></i></a><a href="https://www.linkedin.com/in/felixk" class="btn btn-linkedin">
                <i class="fa fa-linkedin"></i></a><a href="https://github.com/talfco" class="btn btn-github">
                <i class="fa fa-github"></i></a>
          </div>
          <p>
            © 2018 All rights reserved 
          </p>
        </footer>
      </div>
    </div>
    <script src="../../../js/all.js"></script>
  </body>
</html>